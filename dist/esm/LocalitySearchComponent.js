import{c as e}from"./_commonjsHelpers-8b4586d6.js";import{_ as t,r,F as n}from"./Form-05721749.js";import{_ as o}from"./slicedToArray-234eb55e.js";import a,{forwardRef as c,useState as i,useRef as s,useEffect as l}from"react";import{_ as u}from"./extends-64d70faf.js";import{T as m,u as f,a as d,I as p}from"./Typeahead-1d4401bd.js";import"./warning-64d0a8e4.js";import"./index-9df135be.js";import{V as h}from"./Validate-0932f172.js";import{a as g,_ as y}from"./defineProperty-475080e2.js";import"./index-5b0446e7.js";import"react/jsx-runtime";import"./FloatingLabel-618fc546.js";import"./ThemeProvider-7619b1ec.js";import"./unsupportedIterableToArray-26c08a6b.js";import"./InputGroupContext-6eee73f3.js";import"./createClass-2eab1421.js";import"./objectWithoutPropertiesLoose-87a5ea27.js";import"./setPrototypeOf-7ad06ad6.js";import"./usePopper-bf05a757.js";import"react-dom";var v,E,b=c((function(e,t){return a.createElement(m,u({},f(e),{ref:t}))})),w={};
/*! https://mths.be/base64 v1.0.0 by @mathias | MIT license */
v={get exports(){return w},set exports(e){w=e}},E=w,function(t){var r=E,n=v&&v.exports==r&&v,o="object"==typeof e&&e;o.global!==o&&o.window!==o||(t=o);var a=function(e){this.message=e};(a.prototype=new Error).name="InvalidCharacterError";var c=function(e){throw new a(e)},i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=/[\t\n\f\r ]/g,l={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&c("The string to be encoded contains characters outside of the Latin1 range.");for(var t,r,n,o,a=e.length%3,s="",l=-1,u=e.length-a;++l<u;)t=e.charCodeAt(l)<<16,r=e.charCodeAt(++l)<<8,n=e.charCodeAt(++l),s+=i.charAt((o=t+r+n)>>18&63)+i.charAt(o>>12&63)+i.charAt(o>>6&63)+i.charAt(63&o);return 2==a?(t=e.charCodeAt(l)<<8,r=e.charCodeAt(++l),s+=i.charAt((o=t+r)>>10)+i.charAt(o>>4&63)+i.charAt(o<<2&63)+"="):1==a&&(o=e.charCodeAt(l),s+=i.charAt(o>>2)+i.charAt(o<<4&63)+"=="),s},decode:function(e){var t=(e=String(e).replace(s,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&c("Invalid character: the string to be decoded is not correctly encoded.");for(var r,n,o=0,a="",l=-1;++l<t;)n=i.indexOf(e.charAt(l)),r=o%4?64*r+n:n,o++%4&&(a+=String.fromCharCode(255&r>>(-2*o&6)));return a},version:"1.0.0"};if(r&&!r.nodeType)if(n)n.exports=l;else for(var u in l)l.hasOwnProperty(u)&&(r[u]=l[u]);else t.base64=l}(e);var A="GET",O="/crm/mart-common";function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var C=function(e){return 200!==e.status?new Promise((function(e){return e({statusCode:"CLIENT_ERROR",message:"Something went wrong. Please try again!"})})):e.data},S=function(){var e=t(r.mark((function e(t,n){var a,c,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},(c={}).baseURL="http://localhost:82/",Object.entries(t).map((function(e){var t=o(e,2),r=t[0],a=t[1];n[r]&&"object"==g(n[r])?c[r]=L(L({},a),n[r]):c[r]=a})),c=L(L({},n),c),(i=c.params)&&Object.keys(i).forEach((function(e,t){if(Array.isArray(i[e])){var r=i[e],n="";r.forEach((function(e,t){n+=e+(t!==r.length-1?",":"")})),a[e]=n}else!i[e]||"string"!=typeof i[e]||-1===i[e].indexOf("+")&&-1===i[e].indexOf("&")?a[e]=i[e]:a[e]=encodeURIComponent(i[e])})),c.params=a,c&&c.headers&&(c.headers.relativeUrl=c.url),c.endPoint&&(c.url=c.endPoint+c.url),e.abrupt("return",d(c).then((function(e){return C(e)})).catch((function(e){return"Network Error"===e.message||"ECONNABORTED"===e.code||e&&e.response&&400===e.response.status?new Promise((function(e){return e({statusCode:"404",message:"Network Error"})})):new Promise((function(t,r){return r(e)}))})));case 11:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),x={GET_LOCALITY_AUTO_SUGGESTIONS:{url:"/getLocalityAutoSuggestions",method:A,endPoint:O},SET_SELECTED_LOCALITY:{url:"/setLocality",method:A,endPoint:O}};function N(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){i=!0,a=e},f:function(){try{c||null==r.return||r.return()}finally{if(i)throw a}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var I=w,P=function(e){var c=h(),u=Object.freeze({getLocalityAutoSuggestions:function(e){return S(x.GET_LOCALITY_AUTO_SUGGESTIONS,e)},setSelectedLocality:function(e){return S(x.SET_SELECTED_LOCALITY,e)}}),m=i(!1),f=o(m,2),d=f[0],g=f[1],y=i([]),v=o(y,2),E=v[0],w=v[1],A=s(),O=i(""),j=o(O,2),L=j[0],C=j[1],T=i([]),P=o(T,2),k=P[0],_=P[1];l((function(){A.current.focus()}),[]);var U,R,D,F,G,z=(U=function(t){if(c.isNotEmpty(t)&&t.length>0||(w([]),g(!1)),c.isNotEmpty(t)&&t.trim().length>=3){g(!0);var r={localitySearchStr:I.encode(t)},n={headers:{customerId:e.customerId},params:r};u.getLocalityAutoSuggestions(n).then((function(e){if(c.isNotEmpty(e)&&"SUCCESS"==e.statusCode){var t,r=[],n=N(e.dataObject.suggestedLocations);try{for(n.s();!(t=n.n()).done;){var o=t.value,a=o.location.indexOf(","),i=o.location,s="India";if(null!=i&&-1!=i.indexOf(",")&&(i=o.location.substring(0,a),s=o.location.substring(a+1,o.location.length)),o.mainLocation=i,o.address=s,r.push(o),r.length>=5)break}}catch(e){n.e(e)}finally{n.f()}w(r),g(!1)}else"FAILURE"==e.statusCode&&(console.log("Error: "+e.message),w([]),g(!1))})).catch((function(e){console.log(e)}))}},R=500,function(){var e=this,t=arguments;return clearTimeout(F),F=setTimeout((function(){F=null,D||(G=U.apply(e,t))}),R),D&&!F&&(G=U.apply(e,t)),G}),B=function(n){_(n);var o="";n.map((function(e){c.isNotEmpty(e.location)&&(o=e.location)})),C(o),function(n){c.isNotEmpty(n)&&g(!0);var o={location:n},a={locationInfo:JSON.stringify(o)},i={headers:{customerId:e.customerId},params:a};u.setSelectedLocality(i).then(function(){var n=t(r.mark((function t(n){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c.isNotEmpty(n)&&"SUCCESS"===n.statusCode?(g(!1),void 0!==e.setLocality&&e.setLocality((function(e){return!e}))):"FAILURE"==n.statusCode&&console.log("Error: "+n.message);case 1:case"end":return t.stop()}}),t)})));return function(e){return n.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}(o)};return a.createElement("form",{className:"form-inline locality","data-type":"locality-search"},a.createElement("div",{className:"inputgroup d-flex align-items-center"},a.createElement(n.Group,null,a.createElement(p,null,a.createElement(p.Text,null,"Locality"),a.createElement(b,{id:"LocalityName",filterBy:function(){return!0},isLoading:d,labelKey:e.displayFullAddress?function(e){return"".concat(e.location)}:function(e){return"".concat(e.mainLocation)},minLength:3,maxResults:100,ref:A,onKeyDown:function(e){var t;"Enter"===e.key?(t=e.target.value,A.current.clear(),c.isNotEmpty(t)&&t.trim().length>=3&&E.length>0&&B([].concat(E[0]))):z()},onSearch:z,onChange:function(e){B(e)},defaultInputValue:e.defaultAddress?e.defaultAddress:"",options:E,placeholder:"Type your area name / pincode",selected:k,renderMenuItemChildren:function(e,t){return a.createElement(a.Fragment,{key:t},a.createElement("li",{className:0==t?"no-gutters active":"no-gutters"},a.createElement("div",{className:"col"},a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M11 4a3 3 0 11-6 0 3 3 0 016 0z"}),a.createElement("path",{d:"M7.5 4h1v9a.5.5 0 01-1 0V4z"})),a.createElement("p",null,a.createElement("span",{className:"d-block text-truncate",title:e.mainLocation},e.mainLocation),a.createElement("small",{className:"m-0"},a.createElement("span",{className:"d-block text-truncate",title:e.address},e.address))),a.createElement("svg",{className:"chevron-right",width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{fillRule:"evenodd",d:"M4.646 1.646a.5.5 0 01.708 0l6 6a.5.5 0 010 .708l-6 6a.5.5 0 01-.708-.708L10.293 8 4.646 2.354a.5.5 0 010-.708z",clipRule:"evenodd"})))))}},(function(e){return a.createElement("div",{className:"rbt-aux"},!!e.length&&a.createElement(Loader,null))})),a.createElement("button",{className:"inner-btn",onClick:function(e){e.preventDefault(),A.current.clear(),_([]),w([])}},"X")))),e.displayCurrentLocation&&a.createElement("div",{className:"d-block w-100 mt-2"},a.createElement("p",{id:"currentLocation",className:"form-text text-muted w-100 mb-0"},"Current Location: ",a.createElement("strong",{className:"text-dark"},L))))};export{P as default};
//# sourceMappingURL=LocalitySearchComponent.js.map
